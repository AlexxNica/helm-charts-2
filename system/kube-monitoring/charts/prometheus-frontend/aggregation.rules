prometheus_local_storage_ingested_samples_total_rate{} = rate(prometheus_local_storage_ingested_samples_total[5m])
swift_cluster_storage_used_percent_average{} = avg(swift_cluster_prostorage_used_percent_gauge_average < inf) by (region)

# consolidated resource consumption metrics for submission to prometheus-global:
# max() flattens the metrics from different generations of Limes pods into one series,
# so that any subsequent sum() does not double-count
limes_consolidated_cluster_capacity{} = max(label_join(limes_cluster_capacity, "full_resource", "/", "service", "resource")) by (full_resource,os_cluster)
limes_consolidated_domain_quota{} = max(label_join(limes_domain_quota, "full_resource", "/", "service", "resource")) by (full_resource,os_cluster,domain)
limes_consolidated_domain_usage{} = sum(max(label_join(limes_project_usage, "full_resource", "/", "service", "resource")) by (full_resource,os_cluster,domain,project)) by (full_resource,os_cluster,domain)
openstack_compute_instances_total{} = sum(openstack_compute_instances_gauge) by (flavor_name,vm_state)
